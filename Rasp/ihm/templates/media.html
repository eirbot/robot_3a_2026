<!DOCTYPE html>
<html>

<head>
    <title>EIRBOT - MEDIA STUDIO</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/media.css') }}">

    <script src="{{ url_for('static', filename='js/socket.io.js') }}"></script>
    <script src="{{ url_for('static', filename='js/common.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/media.js') }}" defer></script>
</head>

<body>
    <div class="header">
        <a href="/" class="btn-back">‚¨Ö RETOUR</a>
        <div style="font-weight:900; font-size:1.5em;">MEDIA STUDIO</div>
        <div class="sys-info" id="sys-info">...</div>
    </div>

    <div class="tabs-container">
        <button class="tab-btn active" onclick="switchTab('audio')">üéµ AUDIO STUDIO</button>
        <button class="tab-btn" onclick="switchTab('leds')">üí° LED STUDIO</button>
    </div>

    <div class="media-container" id="tab-audio">
        <div class="panel-left">
            <div class="panel-header">
                <h3>üìÇ Fichiers Audio</h3>
                <small>Glisser-d√©poser pour uploader</small>
            </div>
            <div id="file-list" class="file-list">
                <div class="empty-msg">Chargement...</div>
            </div>
        </div>

        <div class="panel-right">
            <div class="player-box">
                <h3>üéµ Lecteur</h3>
                <div class="now-playing" id="now-playing-text">Aucune lecture</div>
                <audio id="audio-preview" controls style="width:100%; margin: 15px 0;"></audio>
                <div class="player-controls">
                    <button class="btn-ctrl" onclick="playPrev()">‚èÆ</button>
                    <button class="btn-ctrl" onclick="playNext()">‚è≠</button>
                </div>
                <button class="btn-robot-test" onclick="playOnRobot()" style="margin-top:15px;">üì¢ Tester sur le
                    Robot</button>
                <button class="btn-robot-test" onclick="stopAudio()"
                    style="margin-top:5px; background-color: #d32f2f;">‚èπ STOP ROBOT</button>

                <div style="margin-top: 15px; border-top: 1px solid #444; padding-top: 10px;">
                    <label style="display:block; font-weight:bold; color: #2196F3;">
                        Volume Robot : <span id="volValue">50</span>%
                    </label>
                    <input type="range" min="0" max="100" value="50" step="1" oninput="changeVolume(this.value)"
                        style="width: 100%;">
                </div>
            </div>

            <div class="config-box">
                <h3>‚öôÔ∏è Assignations Robot</h3>
                <div class="assign-row"><span>üé¨ INTRO :</span> <span id="assign-intro" class="assign-val">...</span>
                </div>
                <div class="assign-row"><span>üîÅ MATCH :</span> <span id="assign-match_loop"
                        class="assign-val">...</span></div>
                <div class="assign-row"><span>üèÅ FIN :</span> <span id="assign-outro" class="assign-val">...</span>
                </div>
            </div>
        </div>
    </div>

    <!-- NOUVEL ONGLET LEDS -->
    <div class="media-container" id="tab-leds" style="display:none;">
        <div class="panel-left" style="flex:2; border:none; background:transparent;">
            <div class="led-strip-container">
                <h3>VUE BANDEAU (60 LEDs) - <a href="/led_studio" style="color:#2196F3;">Ouvrir Studio Avanc√© ‚ûö</a></h3>
                <div class="led-toolbar">
                    <button onclick="clearPixels()">üßπ Tout √âteindre</button>
                    <button onclick="fillPixels()">üé® Remplir Tout</button>
                </div>
                <div id="led-visualizer" class="led-visualizer">
                    <!-- G√©n√©r√© par JS -->
                </div>
            </div>
        </div>

        <div class="panel-right">
            <div class="led-box">
                <h3>üé® Palette & Contr√¥les</h3>

                <div class="led-controls-grid">
                    <div class="led-section">
                        <label>Couleur Active (Cliquer pour peindre)</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="led-color-picker" value="#ff0000"
                                oninput="setLedColor(this.value, false)">
                        </div>
                    </div>

                    <div class="led-section">
                        <label>Presets Rapides</label>
                        <div class="preset-row">
                            <button style="background:#F44336;" onclick="setLedColor('#FF0000')"></button>
                            <button style="background:#4CAF50;" onclick="setLedColor('#00FF00')"></button>
                            <button style="background:#2196F3;" onclick="setLedColor('#0000FF')"></button>
                            <button style="background:#FFEB3B;" onclick="setLedColor('#FFFF00')"></button>
                            <button style="background:#E91E63;" onclick="setLedColor('#FF00FF')"></button>
                            <button style="background:#00BCD4;" onclick="setLedColor('#00FFFF')"></button>
                            <button style="background:#ffffff;" onclick="setLedColor('#FFFFFF')"></button>
                        </div>
                    </div>

                    <div class="led-section">
                        <label>Animations Globales</label>
                        <div class="anim-row">
                            <button class="btn-anim" onclick="setLedAnim('RAINBOW')">üåà Rainbow</button>
                            <button class="btn-anim" onclick="setLedAnim('FLASH')">‚ö° Flash</button>
                            <button class="btn-anim" onclick="setLedAnim('BREATHE')">üå¨Ô∏è Breathe</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="context-menu" class="context-menu">
        <div class="ctx-title" id="ctx-filename">Fichier.mp3</div>
        <hr>
        <div class="ctx-item" onclick="assignTrack('intro')">üé¨ D√©finir comme INTRO</div>
        <div class="ctx-item" onclick="assignTrack('match_loop')">üîÅ D√©finir comme MATCH LOOP</div>
        <div class="ctx-item" onclick="assignTrack('outro')">üèÅ D√©finir comme OUTRO</div>
        <hr>
        <div class="ctx-item delete" onclick="deleteTrack()">üóëÔ∏è Supprimer (TODO)</div>
    </div>

</body>

</html>